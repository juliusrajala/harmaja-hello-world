(()=>{var ge=Object.assign;function Je(r,...e){for(let t=0,n=e.length;t<n;t++)r=e[t](r);return r}var xe=class{pipe(...e){return Je(this,...e)}};var ee=class extends xe{constructor(e){super();this.desc=new R(e)}toString(){return this.observableType()+" "+this.desc}forEach(e){return this.consume().subscribe(e)}log(e){return this.forEach(t=>e===void 0?console.log(t):console.log(e,t))}},P=class extends ee{constructor(e){super(e)}forEach(e){return this.subscribe(e)}consume(){return this}},j=class extends ee{constructor(e){super(e.desc);this._source=e}consume(){if(this._source===null)throw Error(`Seed ${this.toString()}\xA0already consumed`);let e=this._source;return this._source=null,e}};function O(r){var e={}.hasOwnProperty;try{if(ce++,r instanceof ee)return O(r.desc);if(r==null)return"undefined";if(r instanceof Function)return"fn";if(r instanceof Array)return ce>5?"[..]":"["+r.map(O).toString()+"]";if(r.toString&&r.constructor!==Object)return r.toString();if(typeof r=="object"){if(ce>5)return"{..}";var t=[];for(var n in r){if(!e.call(r,n))continue;let o=function(){try{return r[n]}catch(i){return i}}();t.push(O(n)+":"+O(o))}return"{"+t+"}"}else return r}finally{ce--}}var ce=0;var y=7,C=2,z=4,$=16,K=32,F=80,$r=256,Qe=512;var Br=8448;function B(r,e){return r?(r._L&e)===e:!1}function w(r){return B(r,y|$)}function L(r){return B(r,C|$)}function pe(r){return B(r,y|K)}function H(r){return B(r,C|K)}function Ze(r){return B(r,y|F)}function Se(r){return B(r,C|F)}function Ee(r){return r._L!==void 0}var R=class{constructor(e){this.desc=e}toString(){if(typeof this.desc=="string")return this.desc;if(this.desc instanceof R)return this.desc.toString();if(this.desc.length==2)return`${O(this.desc[0])}(${this.desc[1].map(O).join(",")})`;if(this.desc.length===3)return`${O(this.desc[0])}.${this.desc[1]}(${this.desc[2].map(O).join(",")})`;throw Error("Unexpected desc: "+O(this.desc))}};function we(r,e){let[t,n]=e;return[r,t,n]}var Ne=class{constructor(){this._L=$r}};var er=class extends Ne{constructor(){super(...arguments);this._L=Br}};var kr=new er;var _e=class{constructor(e){this._L=Qe,this.subscribe=e}};function Oe(r){return B(r,Qe)}function rr(r){return e=>e.applyScope(r)}function v(r,e){return e!==void 0?rr(e)(r):r}function h(){}function g(r,e){return e.desc=new R(r),e}var re="__meta",k=class{constructor(){this._observers={},this._count=0,this._ended=!1}dispatch(e,t){if(this._observers[e])for(let n of this._observers[e])n[0](t)}dispatchEnd(e){if(this._observers[e])for(let t of this._observers[e])t[1]&&t[1]();this._ended=!0}on(e,t,n=h){this._observers[e]||(this._observers[e]=[]);let o=[t,n];return this._ended?(n(),h):(this._observers[e].push(o),e!==re&&(this._count++,this._count==1&&this.dispatch(re,1)),()=>{var s;if(!this._observers[e])return;let i=this._observers[e].indexOf(o);i>=0&&(this._observers[e].splice(i,1),((s=this._observers.key)==null?void 0:s.length)===0&&delete this._observers[e],e!==re&&(this._count--,this._count==0&&this.dispatch(re,0)))})}onObserverCount(e){return this.on(re,e,void 0)}hasObservers(){return this._count>0}};var x=Te(r=>{r()});function Te(r){return new _e(r)}function tr(r){let e=[...new Set(r.filter(t=>t!==x))];return e.length===0?x:e.length===1?e[0]:Te((t,n)=>{let o=0,i=0,s=null;e.forEach(u=>{u.subscribe(()=>(o++,o===e.length&&(s=t()),()=>{o--,i++,i==1&&s()}))})})}var Pe={},Ce={};function nr(r,e){if(e===Pe)throw Error(`${r} not in scope yet`);if(e===Ce)throw Error(`${r} not in scope any more`);return e}function Y(r,e){let t=h,n=!1;return r.subscribe(()=>(n||(t=e()),()=>{t()})),()=>{n=!0,t(),t=h}}function or(r,e){return(t,n)=>Y(r,()=>e(t,n))}var V=class extends P{observableType(){return"Property"}constructor(e){super(e)}subscribe(e,t){return Y(this.getScope(),()=>{let n=this.onChange(e,t);return e(this.get()),n})}applyScope(e){return new A(this.desc,this.get.bind(this),this.onChange.bind(this),e)}},A=class extends V{constructor(e,t,n,o){super(e);this._L=$|y,this.get=t,this._onChange=n,this._scope=o}onChange(e,t=h){return Y(this.getScope(),()=>{let n=this.get();return this._onChange(o=>{o!==n&&(n=o,e(o))},()=>t())})}getScope(){return this._scope}},te=class extends V{constructor(e,t){super(e.desc);this._L=$|y,this._dispatcher=new k,this._value=Pe,this._scope=t,this._source=e.consume(),t.subscribe(()=>{let n=this._source.onChange(o=>{o!==this._value&&(this._value=o,this._dispatcher.dispatch("change",o))},()=>this._dispatcher.dispatchEnd("change"));return this._value=this._source.get(),()=>{this._value=Ce,n()}})}onChange(e,t){return this._dispatcher.on("change",e,t)}get(){return nr(this,this._value)}getScope(){return this._scope}},S=class extends j{constructor(e,t,n){super(new ir(e,t,n));this._L=$|C}observableType(){return"PropertySeed"}applyScope(e){return new te(this,e)}},ir=class extends P{constructor(e,t,n){super(e);this._L=$|z,this._started=!1,this._subscribed=!1,this._get=t,this.onChange_=n}observableType(){return"PropertySource"}get(){if(this._started)throw Error("PropertySeed started already: "+this);return this._get()}onChange(e,t){if(this._subscribed)throw Error("Multiple subscriptions not allowed to PropertySeed instance: "+this);return this._subscribed=!0,this.onChange_(n=>{this._started=!0,e(n)},t)}subscribe(e,t){let n=this.onChange(e,t);return e(this.get()),n}applyScope(e){return new te(this,e)}};var sr=class extends V{constructor(e,t){super(e);this._L=F|y,this._dispatcher=new k,this._value=t,this.set=this.set.bind(this)}observableType(){return"Atom"}onChange(e,t){return this._dispatcher.on("change",e,t)}get(){return this._value}set(e){this._value=e,this._dispatcher.dispatch("change",e)}modify(e){this.set(e(this._value))}getScope(){return x}applyScope(e){return new W(this,e)}};var Fe=class extends V{constructor(e,t,n){super(e);this._L=F|y,this._root=t,this._lens=n,this.set=this.set.bind(this)}observableType(){return"Atom"}get(){return this._lens.get(this._root.get())}set(e){this._root.set(this._lens.set(this._root.get(),e))}modify(e){this._root.modify(t=>this._lens.set(t,e(this._lens.get(t))))}onChange(e,t){return Y(this.getScope(),()=>{let n=this.get();return this._root.onChange(o=>{let i=this._lens.get(o);i!==n&&(n=i,e(i))},t)})}getScope(){return this._root.getScope()}applyScope(e){return new W(this,e)}},ur=class extends V{constructor(e,t,n){super(e);this._L=F|y,this._input=t,this.set=n.bind(this)}observableType(){return"Atom"}onChange(e,t){return this._input.onChange(e,t)}get(){return this._input.get()}modify(e){this.set(e(this.get()))}getScope(){return this._input.getScope()}applyScope(e){return new W(this,e)}},Le=class extends te{constructor(e,t){super(e,t);this._L=F|y,this.set=this._source.set.bind(this)}observableType(){return"Atom"}modify(e){this.set(e(this.get()))}applyScope(e){return new W(this,e)}},W=class extends A{constructor(e,t){super(e.desc,e.get.bind(e),e.onChange.bind(e),t);this._src=e}set(e){this._src.set(e)}modify(e){this._src.modify(e)}applyScope(e){return new W(this,e)}},le=class extends j{constructor(e,t,n,o){super(new ar(e,t,n,o));this._L=F|C}observableType(){return"AtomSeed"}applyScope(e){return new Le(this,e)}},ar=class extends P{constructor(e,t,n,o){super(e);this._L=F|z,this._started=!1,this._subscribed=!1,this._get=t,this.onChange_=n,this.set=o}observableType(){return"AtomSource"}get(){if(this._started)throw Error("PropertySeed started already: "+this);return this._get()}onChange(e,t){if(this._subscribed)throw Error("Multiple subscriptions not allowed to PropertySeed instance: "+this);return this._subscribed=!0,this.onChange_(n=>{this._started=!0,e(n)},t)}subscribe(e,t){let n=this.onChange(e,t);return e(this.get()),n}applyScope(e){return new Le(this,e)}};function fr(r,e){return arguments.length==1?new sr(["Atom",[r]],r):new ur(["DependentAtom",[r,e]],r,e)}var Ie=class extends P{constructor(){super(...arguments);this._L=K|y}observableType(){return"EventStream"}applyScope(e){return new M(this.desc,or(e,this.subscribe.bind(this)),e)}},Me=class extends Ie{constructor(e,t){super(e);this.dispatcher=new k,this._scope=t}subscribe(e,t){return this.dispatcher.on("value",e,t)}getScope(){return this._scope}},M=class extends Ie{constructor(e,t,n){super(e);this._scope=n,this.subscribe=t}getScope(){return this._scope}},Ue=class extends Me{constructor(e,t){super(e.desc,t);let n=e.consume();t.subscribe(()=>n.subscribe(o=>this.dispatcher.dispatch("value",o),()=>this.dispatcher.dispatchEnd("value")))}},cr=class extends P{constructor(e,t){super(e);this._L=K|z,this.subscribe=t}observableType(){return"EventStreamSource"}applyScope(e){return new Ue(this,e)}},_=class extends j{constructor(e,t){super(new cr(e,t));this._L=K|C}observableType(){return"EventStreamSeed"}applyScope(e){return new Ue(this,e)}};function Ge(r){return r=Array.prototype.slice.call(r),r.flatMap(Vr)}function Vr(r){return Ee(r)?[r.consume()]:r instanceof Array?Ge(r):[De(r)]}function pr(r){return r[0]instanceof Function?[Ge(Array.prototype.slice.call(r,1)),r[0]]:[Ge(Array.prototype.slice.call(r,0,r.length-1)),r[r.length-1]]}var lr={changes:r=>r,init:r=>r};function X(r,e,t){return n=>{let o=we(n,r);if(H(n)){let s=e instanceof Function?e:e.changes,u=n.consume();return v(new _(o,s(u.subscribe.bind(u))),t)}let i=e;if(Se(n)){let s=n.consume();return v(new le(o,()=>i.init(s.get()),mr(s,i),u=>s.set(u)),t)}else if(L(n)){let s=n.consume();return v(new S(o,()=>i.init(s.get()),mr(s,i)),t)}else throw Error("Unknown observable "+n)}}function mr(r,e){if(r===void 0)throw Error("Assertion failed");return e.changes(r.onChange.bind(r))}function ne(r){if(!r||Oe(r))return X(["cached",[]],lr,r);{let e=null;return function(...t){if(e!==null&&Wr(e[0],t))return e[1];let n=r(...t);return e=[t,n],n}}}function Wr(r,e){if(r.length!==e.length)throw Error("Argument count mismatch");for(let t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function qe(...r){let[e,t]=pr(r);t=ne(t);function n(){return e.map(u=>u.get())}let o=()=>t(...n());function i(u,a=h){let f=0,c=e.map((p,d)=>p.onChange(b=>{m[d]=b,u(t(...m))},()=>{f++,f==e.length&&a()})),m=n();return()=>{c.forEach(p=>p())}}let s=["combine",[e,t]];if(e.length===0||w(e[0])){let u=tr(e.map(a=>a.getScope()));return new A(s,o,i,u)}else return new S(s,o,i)}function T(r){return e=>{let t=[e,"map",[r]],n=w(r)?()=>r.get():r;if(pe(e))return new M(t,oe(e.subscribe.bind(e),n),e.getScope());if(H(e)){let o=e.consume();return new _(t,oe(o.subscribe.bind(o),n))}else{if(w(e))return n=ne(n),new A(t,()=>n(e.get()),oe(e.onChange.bind(e),n),e.getScope());if(L(e)){let o=e.consume();return n=ne(n),new S(t,()=>n(o.get()),oe(o.onChange.bind(o),n))}}throw Error("Unknown observable")}}function oe(r,e){return(t,n)=>r(zr(t,e),n)}function zr(r,e){return t=>r(e(t))}function hr(r,e){return t=>{let n=t.consume();return v(new S([t,"toProperty",[r]],()=>r,(o,i)=>n.subscribe(o,i)),e)}}function dr(){return new M("never",(r,e=h)=>(e(),h),x)}function De(r){return g(["constant",[r]],hr(r,x)(dr()))}function vr(r){return{get:e=>e[r],set:(e,t)=>ge(ge({},e),{[r]:t})}}function br(r){return{get:e=>e[r],set:(e,t)=>t===void 0?[...e.slice(0,r),...e.slice(r+1)]:[...e.slice(0,r),t,...e.slice(r+1)]}}var us=Symbol();var ie=function(){return ie=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o])}return r},ie.apply(this,arguments)},me=function(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),o=0,e=0;e<t;e++)for(var i=arguments[e],s=0,u=i.length;s<u;s++,o++)n[o]=i[s];return n},U=function(r){return r},je=function(r){return{_tag:"Left",value:r}},he=function(r){return{_tag:"Right",value:r}},Xr=function(r,e,t){return t._tag==="Left"?r(t.value):e(t.value)},Jr={dimap:function(r,e,t){return function(n){return e(t(r(n)))}},first:function(r){return function(e){var t=e[0],n=e[1];return[r(t),n]}},right:function(r){return function(e){return e._tag==="Left"?e:he(r(e.value))}},wander:function(r){return function(e){return e.map(r)}}};var Qr=function(r){return{dimap:function(e,t,n){return function(o){return n(e(o))}},first:function(e){return function(t){var n=t[0],o=t[1];return e(n)}},right:function(e){return function(t){return t._tag==="Left"?r.empty():e(t.value)}},wander:function(e){return function(t){return r.foldMap(e,t)}}}},$e={Equivalence:{Equivalence:"Equivalence",Iso:"Iso",Lens:"Lens",Prism:"Prism",Traversal:"Traversal",Getter:"Getter",AffineFold:"AffineFold",Fold:"Fold",Setter:"Setter"},Iso:{Equivalence:"Iso",Iso:"Iso",Lens:"Lens",Prism:"Prism",Traversal:"Traversal",Getter:"Getter",AffineFold:"AffineFold",Fold:"Fold",Setter:"Setter"},Lens:{Equivalence:"Lens",Iso:"Lens",Lens:"Lens",Prism:"Prism",Traversal:"Traversal",Getter:"Getter",AffineFold:"AffineFold",Fold:"Fold",Setter:"Setter"},Prism:{Equivalence:"Prism",Iso:"Prism",Lens:"Prism",Prism:"Prism",Traversal:"Traversal",Getter:"AffineFold",AffineFold:"AffineFold",Fold:"Fold",Setter:"Setter"},Traversal:{Equivalence:"Traversal",Iso:"Traversal",Lens:"Traversal",Prism:"Traversal",Traversal:"Traversal",Getter:"Fold",AffineFold:"Fold",Fold:"Fold",Setter:"Setter"},Getter:{Equivalence:"Getter",Iso:"Getter",Lens:"Getter",Prism:"AffineFold",Traversal:"Fold",Getter:"Getter",AffineFold:"AffineFold",Fold:"Fold",Setter:void 0},AffineFold:{Equivalence:"AffineFold",Iso:"AffineFold",Lens:"AffineFold",Prism:"AffineFold",Traversal:"Fold",Getter:"AffineFold",AffineFold:"AffineFold",Fold:"Fold",Setter:void 0},Fold:{Equivalence:"Fold",Iso:"Fold",Lens:"Fold",Prism:"Fold",Traversal:"Fold",Getter:"Fold",AffineFold:"Fold",Fold:"Fold",Setter:void 0},Setter:{Equivalence:void 0,Iso:void 0,Lens:void 0,Prism:void 0,Traversal:void 0,Getter:void 0,AffineFold:void 0,Fold:void 0,Setter:void 0}},J=function(r,e){var t=e;return t._tag=r,t},yr=function(r){return r._removable=!0,r};function l(r,e,t){switch(arguments.length){case 2:{var n=function(i,s){return r(i,e(i,s))};return n._tag=$e[r._tag][e._tag],n._removable=e._removable||!1,n}default:{var o=$e[r._tag][e._tag],n=function(s,u){return r(s,e(s,t(s,u)))};return n._tag=$e[o][t._tag],n._removable=t._removable||!1,n}}}var Zr=J("Equivalence",function(r,e){return e}),Be=function(r,e){return J("Iso",function(t,n){return t.dimap(r,e,n)})},I=function(r,e){return J("Lens",function(t,n){return t.dimap(function(o){return[r(o),o]},e,t.first(n))})},ke=function(r,e){return J("Prism",function(t,n){return t.dimap(r,function(o){return Xr(U,e,o)},t.right(n))})},Ve=J("Traversal",function(r,e){return r.dimap(U,U,r.wander(e))}),Nr=function(r){return J("Getter",function(e,t){return e.dimap(r,U,t)})};var gr=function(r,e,t){return r(Jr,function(){return e})(t)};var xr=function(r,e){return r(Qr({}),U)(e)};var Sr=function(r){return I(function(e){return e[r]},function(e){var t,n=e[0],o=e[1];return ie(ie({},o),(t={},t[r]=n,t))})},et=function(r){return I(function(e){for(var t={},n=0,o=r;n<o.length;n++){var i=o[n];t[i]=e[i]}return t},function(e){for(var t=e[0],n=e[1],o=ie({},n),i=0,s=r;i<s.length;i++){var u=s[i];delete o[u]}return Object.assign(o,t)})},We=function(r){return ke(function(e){return r(e)?he(e):je(e)},U)},se=Symbol("__no_match__"),Er=We(function(r){return r!==se}),wr=Symbol("__remove_me__"),ze=function(r){return yr(l(I(function(e){return 0<=r&&r<e.length?e[r]:se},function(e){var t=e[0],n=e[1];if(t===se)return n;if(t===wr)return typeof n=="string"?n.substring(0,r)+n.substring(r+1):me(n.slice(0,r),n.slice(r+1));if(typeof n=="string")return r===0?t+n.substring(1):r===n.length?n.substring(0,r-1)+t:n.substring(0,r)+t+n.substring(r+1);var o=n.slice();return o[r]=t,o}),Er))},rt=ke(function(r){return r===void 0?je(void 0):he(r)},U),tt=function(r){return ke(function(e){return r(e)?he(e):je(e)},U)},nt=I(function(r){return r[0]},function(r){var e=r[0],t=r[1];return[e,t[1]]}),ot=function(r){return yr(l(I(function(e){var t=e.findIndex(r);return t===-1?[se,-1]:[e[t],t]},function(e){var t=e[0],n=t[0],o=t[1],i=e[1];if(n===se)return i;if(n===wr)return me(i.slice(0,o),i.slice(o+1));var s=i.slice();return s[o]=n,s}),nt,Er))},it=function(r){return I(function(e){var t=e.map(function(n,o){return r(n)?o:null}).filter(function(n){return n!=null});return t.map(function(n){return e[n]})},function(e){for(var t=e[0],n=e[1],o=n.map(function(c,m){return r(c)?m:null}).filter(function(c){return c!=null}),i=n.slice(),s=0,u=0,a=o;u<a.length;u++){var f=a[u];i[f]=t[s],s++}return i})},st=function(r){return I(function(e){return e===void 0?r:e},function(e){var t=e[0],n=e[1];return t})},ut=I(function(r){},function(r){var e=r[0],t=r[1];return e===void 0?t:me([e],t)}),at=I(function(r){},function(r){var e=r[0],t=r[1];return e===void 0?t:me(t,[e])}),ft=l(Be(function(r){return r.split("")},function(r){return r.join("")}),Ve),ct=l(Be(function(r){return r.split(/\b/)},function(r){return r.join("")}),Ve,We(function(r){return!/\s+/.test(r)})),pt=function(){function r(e){this._ref=e}return Object.defineProperty(r.prototype,"_tag",{get:function(){return this._ref._tag},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"_removable",{get:function(){return this._ref._removable},enumerable:!1,configurable:!0}),r.prototype.compose=function(e){return new r(l(this._ref,e._ref))},r.prototype.iso=function(e,t){return new r(l(this._ref,Be(e,t)))},r.prototype.prop=function(e){return new r(l(this._ref,Sr(e)))},r.prototype.path=function(e){return new r(e.reduce(function(t,n){return l(t,Sr(n))},this._ref))},r.prototype.pick=function(e){return new r(l(this._ref,et(e)))},r.prototype.filter=function(e){return new r(l(this._ref,it(e)))},r.prototype.valueOr=function(e){return new r(l(this._ref,st(e)))},r.prototype.optional=function(){return new r(l(this._ref,rt))},r.prototype.guard_=function(){var e=this;return function(t){return e.guard(t)}},r.prototype.guard=function(e){return new r(l(this._ref,tt(e)))},r.prototype.at=function(e){return new r(l(this._ref,ze(e)))},r.prototype.head=function(){return new r(l(this._ref,ze(0)))},r.prototype.index=function(e){return new r(l(this._ref,ze(e)))},r.prototype.find=function(e){return new r(l(this._ref,ot(e)))},r.prototype.elems=function(){return new r(l(this._ref,Ve))},r.prototype.to=function(e){return new r(l(this._ref,Nr(e)))},r.prototype.when=function(e){return new r(l(this._ref,We(e)))},r.prototype.chars=function(){return new r(l(this._ref,ft))},r.prototype.words=function(){return new r(l(this._ref,ct))},r.prototype.prependTo=function(){return new r(l(this._ref,ut))},r.prototype.appendTo=function(){return new r(l(this._ref,at))},r}();var lt=new pt(Zr);function _r(r){return function(e){return xr(r._ref,e)}}function Or(r){return function(e){return function(t){return gr(r._ref,e,t)}}}var Ar=["Lens","Equivalence","Iso"];function Tr(r){let e=r._tag;if(e){if(!Ar.includes(e))throw Error(`Only ${Ar.join("/")} optics supported from optics-ts. Given optic is a ${e}.`);let t=r;return{get:_r(t),set:(n,o)=>Or(t)(o)(n)}}return r}function de(...r){if(r[r.length-1]instanceof Function){let e=0;for(;!(r[e]instanceof Function);)e++;let t=r.slice(0,e);if(t.length===1){let n=t[0],o=n;for(let s=e;s<r.length;s++){let u=r[s];o=T(u)(o)}let i=[n,"view",r.slice(e)];return g(i,o)}else{let n=r[r.length-1];return qe(t,n)}}else{let e=r[0],t=r[1],n=mt(t),o=[e,"view",[t]];return Ze(e)?new Fe(o,e,n):g(o,T(n.get)(e))}}function mt(r){return typeof r=="string"?vr(r):typeof r=="number"?br(r):Tr(r)}function ue(r){return w(r)}function ae(r,e){return r.forEach(e)}var Q=function(){return Q=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o])}return r},Q.apply(this,arguments)},E=function(r){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&r[e],n=0;if(t)return t.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},ve=function(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),o,i=[],s;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(u){s={error:u}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(s)throw s.error}}return i},ht=function(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(ve(arguments[e]));return r},Pr=[];function Lr(r,e){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var o=t.flatMap(Ke);if(e?e.children&&delete e.children:e={},typeof r=="function"){var i=r;Pr.push({});var s=i(Q(Q({},e),{children:o})),u=Pr.pop();return ue(s)?ye([be()],dt(Cr(u),Fr(s))):u.unmountCallbacks||u.mountCallbacks||u.scope?ye(Z(fe(s)),Cr(u)):s}else{if(typeof r=="string")return vt(r,e,o);throw console.error("Unexpected createElement call with arguments",arguments),Error("Unknown type "+r)}}function dt(r,e){return function(t){var n=r(t),o=e(t);return function(){o(),n()}}}var Cr=function(r){return function(e){var t,n;if(r.scope&&(r.mountsController=e),r.mountCallbacks)try{for(var o=E(r.mountCallbacks),i=o.next();!i.done;i=o.next()){var s=i.value;s()}}catch(u){t={error:u}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return function(){var u,a;if(r.unmountCallbacks)try{for(var f=E(r.unmountCallbacks),c=f.next();!c.done;c=f.next()){var m=c.value;m()}}catch(p){u={error:p}}finally{try{c&&!c.done&&(a=f.return)&&a.call(f)}finally{if(u)throw u.error}}}}};function Ke(r){return r instanceof Array?r.flatMap(Ke):[r]}function vt(r,e,t){var n,o,i=document.createElement(r),s=!1,u=function(d,b){d==="contentEditable"&&(s=!0),ue(b)?He(i,function(){var q=ae(b,function(jr){Ir(i,d,jr)});Ye(i,q)}):Ir(i,d,b)};try{for(var a=E(Object.entries(e||{})),f=a.next();!f.done;f=a.next()){var c=ve(f.value,2),m=c[0],p=c[1];u(m,p)}}catch(d){n={error:d}}finally{try{f&&!f.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}return s?bt(i,t):(t||[]).map(fe).flatMap(Z).forEach(function(d){return i.appendChild(d)}),i}function bt(r,e){if(!(!e||e.length==0)){if(e.length!=1)throw Error("contentEditable elements expected to contain zero to one child");var t=e[0];if(!ue(t))throw Error("contentEditable element must have an Observable<string> as child");var n=t;ye([r],function(o){return ae(n,function(i){if(typeof i!="string")throw Error("Value for contentEditable is not string: "+i+" is a "+typeof i+".");i!==r.textContent&&(r.textContent=i)})})}}function be(){var r=document.createTextNode("");return r._h_id=yt++,r}var yt=1;function fe(r){if(r instanceof Array)return r.flatMap(fe);if(typeof r=="string"||typeof r=="number")return document.createTextNode(r.toString());if(r===null||r===!1)return be();if(ue(r))return ye([be()],Fr(r));if(gt(r))return r;throw Error(r+" is not a valid element")}var Fr=function(r){return function(e){return ae(r,function(t){var n=e.currentElements.slice(),o=Ke(t).flatMap(fe).flatMap(Z);o.length===0&&(o=[be()]),Mr(e,n,o)})}};function gt(r){return r instanceof Element||r instanceof Text}function Ir(r,e,t){if(e==="ref"){if(typeof t!="function")throw Error("Expecting ref prop to be a function, got "+t);var n=t;He(r,function(){return n(r)});return}if(e.startsWith("on"))e=e.toLowerCase(),e=e==="ondoubleclick"?"ondblclick":e,r[e]=t;else if(e==="style"){var o=Object.entries(t).filter(function(i){var s=ve(i,2),u=s[0],a=s[1];return u!==""}).map(function(i){var s=ve(i,2),u=s[0],a=s[1];return xt(u)+": "+a+";"}).join(`
`);r.setAttribute("style",o)}else e==="className"?r.setAttribute("class",t):e in r?r[e]=t:r.setAttribute(e,t)}function xt(r){return r.split("").map(function(e){return e==e.toUpperCase()?"-"+e.toLowerCase():e}).join("")}function St(r){var e=r;return e.__h}function D(r){var e=r;if(!e.__h){var t={};e.__h=t}return e.__h}function Ur(r,e){var t=fe(r);return Mr(null,[e],t),t}function Dr(r){var e,t,n,o,i=D(r);if(!i.mounted){if(i.unmounted)throw new Error("Component re-mount not supported");if(i.mounted=!0,i.onMounts)try{for(var s=E(i.onMounts),u=s.next();!u.done;u=s.next()){var a=u.value;a()}}catch(p){e={error:p}}finally{try{u&&!u.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}try{for(var f=E(r.childNodes),c=f.next();!c.done;c=f.next()){var m=c.value;Dr(m)}}catch(p){n={error:p}}finally{try{c&&!c.done&&(o=f.return)&&o.call(f)}finally{if(n)throw n.error}}}}function Gr(r){var e,t,n,o,i=D(r);if(!!i.mounted){if(i.onUnmounts)try{for(var s=E(i.onUnmounts),u=s.next();!u.done;u=s.next()){var a=u.value;a()}}catch(p){e={error:p}}finally{try{u&&!u.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}try{for(var f=E(r.childNodes),c=f.next();!c.done;c=f.next()){var m=c.value;Gr(m)}}catch(p){n={error:p}}finally{try{c&&!c.done&&(o=f.return)&&o.call(f)}finally{if(n)throw n.error}}i.mounted=!1,i.unmounted=!0}}function He(r,e){if(typeof e!="function")throw Error("not a function: "+e);var t=D(r);t.onMounts||(t.onMounts=[]),t.onMounts.push(e)}function Ye(r,e){if(typeof e!="function")throw Error("not a function: "+e);var t=D(r);t.onUnmounts||(t.onUnmounts=[]),!t.onUnmounts.includes(e)&&t.onUnmounts.push(e)}function Et(r,e){var t=St(r);if(!(t===void 0||!t.onUnmounts)){for(var n=0;n<t.onUnmounts.length;n++)if(t.onUnmounts[n]===e){t.onUnmounts.splice(n,1);return}}}function qr(r,e){var t,n,o;try{for(var i=E(r),s=i.next();!s.done;s=i.next()){var u=s.value,a=D(u),f=(o=a.controllers)===null||o===void 0?void 0:o.indexOf(e);if(f===void 0||f<0)throw Error("Controller not attached to "+u);e.unsub&&Et(u,e.unsub)}}catch(c){t={error:c}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}function ye(r,e,t){var n=Q(Q({},t),{currentElements:r});return Xe(r,n,e),r}function Xe(r,e,t,n){for(var o=function(s){var u=r[s],a=D(u);if(a.controllers?a.controllers.includes(e)||a.controllers.push(e):a.controllers=[e],s==0){if(t){if(a.mounted)throw Error("Unexpected: Component already mounted");He(u,function(){var f=t(e);e.unsub=f,u=e.currentElements[0],Ye(u,e.unsub)})}e.unsub&&!n&&Ye(u,e.unsub)}},i=0;i<r.length;i++)o(i)}function wt(r,e,t){var n,o,i=-1,s=-1;if(e.length===0)throw Error("Empty list of nodes");try{for(var u=E(e),a=u.next();!a.done;a=u.next()){var f=a.value,c=r.currentElements.indexOf(f);if(c<0)throw Error("Element not found: "+N(f));if(s>=0&&c!=s+1)throw Error("Non-consecutive nodes "+e);i<0&&(i=c),s=c}}catch(m){n={error:m}}finally{try{a&&!a.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}if(i<0||s<0)throw Error("Assertion failed");r.onReplace&&r.onReplace(e,t),qr(e,r),r.currentElements=ht(r.currentElements.slice(0,i),t,r.currentElements.slice(s+1)),Xe(r.currentElements,r)}function Ot(r,e,t){var n,o;if(!!r){var i=D(e[0]).controllers;if(!i)throw new Error("Assertion failed: Controllers not found for "+N(e[0]));for(var s=i.indexOf(r),u=i.slice(s+1),a=1;a<e.length;a++){var f=D(e[a]).controllers||[],c=f.indexOf(r);if(c<0)throw new Error("Controller "+r+" not found in "+N(e[a]));var m=f.slice(c+1);if(!_t(u,m))throw new Error("Assertion failed: controller array of "+N(e[a])+" ("+f+", replacer index "+c+") not equal to that of "+N(e[0])+" ("+i+").")}try{for(var p=E(u),d=p.next();!d.done;d=p.next()){var b=d.value;wt(b,e,t)}}catch(q){n={error:q}}finally{try{d&&!d.done&&(o=p.return)&&o.call(p)}finally{if(n)throw n.error}}}}function _t(r,e){if(r.length!==e.length)return!1;for(var t=0;t<r.length;t++)if(r[t]!==e[t])return!1;return!0}function At(r,e){if(r.length!==e.length)return!1;for(var t=0;t<r.length;t++)if(!(r[t]instanceof Text&&e[t]instanceof Text&&r[t].textContent&&r[t].textContent===e[t].textContent))return!1;return!0}function Mr(r,e,t){var n,o,i,s,u=Z(e),a=Z(t);if(!At(u,a)){if(r&&(r.currentElements=a,qr(u,r),Xe(a,r)),u.length===0)throw new Error("Cannot replace zero nodes");if(a.length===0)throw new Error("Cannot replace with zero nodes");u[0].parentElement.replaceChild(a[0],u[0]);for(var f=1;f<u.length;f++)u[f].remove();for(var f=1;f<a.length;f++)a[f-1].after(a[f]);Ot(r,u,a);try{for(var c=E(u),m=c.next();!m.done;m=c.next()){var p=m.value;Gr(p)}}catch(q){n={error:q}}finally{try{m&&!m.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}try{for(var d=E(a),b=d.next();!b.done;b=d.next()){var p=b.value;Dr(p)}}catch(q){i={error:q}}finally{try{b&&!b.done&&(s=d.return)&&s.call(d)}finally{if(i)throw i.error}}}}function Z(r){return r instanceof Array?r.flatMap(Z):[r]}function N(r){return r instanceof Array?r.map(N).join(",")||"[]":r instanceof Element?r.outerHTML:r.textContent||(r._h_id!=null?"<placeholder "+r._h_id+">":"<empty text node>")}var G=Lr;var Tt=fr({first:"Hello",second:"World"}),Pt=({appState:r=Tt})=>{let e=de(r,"first"),t=de(r,"second");return t.subscribe(n=>console.log("Target value changed",n)),G("div",null,G("h1",null,"Harmaja"),G("button",{onClick:()=>t.set("creator")},"Click me!"),G("h2",null,e),G("h2",null,t))},Rr=Pt;Ur(G(Rr,null),document.getElementById("harmaja-mount"));})();
//# sourceMappingURL=bundle.js.map
